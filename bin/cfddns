#!/usr/bin/env php
<?php

$user_home = posix_getpwuid(posix_getuid())['dir'];
$autoload = $user_home.'/.composer/vendor/autoload.php';

if (file_exists(__DIR__.'/../vendor/autoload.php')) {
    $autoload = __DIR__.'/../vendor/autoload.php';
}

require $autoload;

$config = new Flatline\CfDdns\Config\Config(
    "cfddns.yml",
    new Symfony\Component\Config\FileLocator([$user_home]),
    new Symfony\Component\Config\Loader\LoaderResolver
);

$app = new Flatline\CfDdns\Application(
    $config->load(),
    new Flatline\CfDdns\CloudFlare\Api\Request
);
$app->run();
